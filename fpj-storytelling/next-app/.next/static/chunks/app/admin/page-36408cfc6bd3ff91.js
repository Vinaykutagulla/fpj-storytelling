(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{1708:function(e,t,s){Promise.resolve().then(s.bind(s,306))},306:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var l=s(1920),a=s(7029),i=s(7437),n=s(2265);function r(){let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[d,c]=(0,n.useState)(null),[o,x]=(0,n.useState)(""),[m,p]=(0,n.useState)(!1),[h,u]=(0,n.useState)("all"),j=e.filter(e=>"all"===h||(e.status||"pending")===h),f=async()=>{try{let e=await fetch("/api/partner-applications/admin",{headers:{Authorization:"Bearer ".concat(o)}});if(e.ok){let s=await e.json();t(s.items||[]),p(!0)}else console.error("Failed to fetch applications"),p(!1)}catch(e){console.error("Error fetching applications:",e)}r(!1)},g=async e=>{try{let s=await fetch("/api/partner-applications/admin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({action:"approve",applicationId:e.id})}),i=await s.json();if(s.ok){let s=(0,a._)((0,l._)({},e),{status:"approved",referral_code:i.referralCode,approval_date:new Date().toISOString()});t(t=>t.map(t=>t.id===e.id?s:t)),alert("Application approved! Referral code: ".concat(i.referralCode)),c(null)}else alert("Error: ".concat(i.error||"Failed to approve application"))}catch(e){console.error("Error approving application:",e),alert("Error approving application")}},v=async(e,s)=>{try{let i=await fetch("/api/partner-applications/admin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({action:"reject",applicationId:e.id,reason:s})}),n=await i.json();if(i.ok){let i=(0,a._)((0,l._)({},e),{status:"rejected",admin_notes:s});t(t=>t.map(t=>t.id===e.id?i:t)),alert("Application rejected successfully"),c(null)}else alert("Error: ".concat(n.error||"Failed to reject application"))}catch(e){console.error("Error rejecting application:",e),alert("Error rejecting application")}};return m?(0,i.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,i.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,i.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Student Partner Admin Dashboard"}),(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsxs)("span",{className:"text-sm text-slate-600",children:[e.length," applications"]}),(0,i.jsx)("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Refresh"})]})]})})}),(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,i.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:e.filter(e=>!e.status||"pending"===e.status).length}),(0,i.jsx)("div",{className:"text-slate-600",children:"Pending Review"})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-green-600",children:e.filter(e=>"approved"===e.status).length}),(0,i.jsx)("div",{className:"text-slate-600",children:"Approved"})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-red-600",children:e.filter(e=>"rejected"===e.status).length}),(0,i.jsx)("div",{className:"text-slate-600",children:"Rejected"})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:e.filter(e=>e.referral_code).length}),(0,i.jsx)("div",{className:"text-slate-600",children:"Active Partners"})]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,i.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Applications"}),(0,i.jsx)("div",{className:"flex gap-2",children:(0,i.jsxs)("select",{value:h,onChange:e=>u(e.target.value),className:"px-3 py-2 border rounded-lg text-sm",children:[(0,i.jsxs)("option",{value:"all",children:["All Applications (",e.length,")"]}),(0,i.jsxs)("option",{value:"pending",children:["Pending (",e.filter(e=>"pending"===(e.status||"pending")).length,")"]}),(0,i.jsxs)("option",{value:"approved",children:["Approved (",e.filter(e=>"approved"===e.status).length,")"]}),(0,i.jsxs)("option",{value:"rejected",children:["Rejected (",e.filter(e=>"rejected"===e.status).length,")"]})]})})]}),(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{className:"bg-slate-50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Student"}),(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Institution"}),(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Year"}),(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Applied"}),(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Status"}),(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Referral Code"}),(0,i.jsx)("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Actions"})]})}),(0,i.jsx)("tbody",{className:"divide-y",children:j.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"font-medium text-slate-900",children:e.name}),(0,i.jsx)("div",{className:"text-sm text-slate-500",children:e.email})]})}),(0,i.jsx)("td",{className:"px-6 py-4 text-slate-900",children:e.institution}),(0,i.jsx)("td",{className:"px-6 py-4 text-slate-900",children:e.year}),(0,i.jsx)("td",{className:"px-6 py-4 text-slate-500",children:new Date(e.created_at).toLocaleDateString()}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("approved"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status||"pending"})}),(0,i.jsx)("td",{className:"px-6 py-4",children:e.referral_code?(0,i.jsx)("span",{className:"font-mono text-sm bg-slate-100 px-2 py-1 rounded",children:e.referral_code}):(0,i.jsx)("span",{className:"text-slate-400",children:"-"})}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)("button",{onClick:()=>c(e),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Review"})})]},e.id))})]})})]})]}),d&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,i.jsx)("div",{className:"px-6 py-4 border-b",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Review Application"}),(0,i.jsx)("button",{onClick:()=>c(null),className:"text-slate-400 hover:text-slate-600",children:"âœ•"})]})}),(0,i.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600",children:"Name"}),(0,i.jsx)("div",{className:"text-slate-900",children:d.name})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600",children:"Email"}),(0,i.jsx)("div",{className:"text-slate-900",children:d.email})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600",children:"Institution"}),(0,i.jsx)("div",{className:"text-slate-900",children:d.institution})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600",children:"Year"}),(0,i.jsx)("div",{className:"text-slate-900",children:d.year})]}),d.phone&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600",children:"Phone"}),(0,i.jsx)("div",{className:"text-slate-900",children:d.phone})]}),d.course&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600",children:"Course"}),(0,i.jsx)("div",{className:"text-slate-900",children:d.course})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Motivation"}),(0,i.jsx)("div",{className:"bg-slate-50 p-3 rounded-lg text-slate-900",children:d.motivation})]}),d.referral_code&&(0,i.jsxs)("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[(0,i.jsx)("div",{className:"font-medium text-green-800",children:"Referral Code Generated"}),(0,i.jsx)("div",{className:"font-mono text-lg text-green-700",children:d.referral_code})]})]}),(0,i.jsxs)("div",{className:"px-6 py-4 border-t bg-slate-50 flex gap-3 justify-end",children:[(0,i.jsx)("button",{onClick:()=>c(null),className:"px-4 py-2 text-slate-600 hover:text-slate-800",children:"Cancel"}),(!d.status||"pending"===d.status)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{let e=prompt("Rejection reason:");e&&v(d,e)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reject"}),(0,i.jsx)("button",{onClick:()=>g(d),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Approve & Generate Code"})]})]})]})})]}):(0,i.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Admin Login"}),(0,i.jsx)("input",{type:"password",placeholder:"Enter admin token",value:o,onChange:e=>x(e.target.value),className:"w-full p-3 border rounded-lg mb-4",onKeyPress:e=>"Enter"===e.key&&f()}),(0,i.jsx)("button",{onClick:f,className:"w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700",children:"Login"})]})})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=1708)}),_N_E=e.O()}]);