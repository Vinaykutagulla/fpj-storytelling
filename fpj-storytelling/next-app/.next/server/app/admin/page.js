(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5562:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o}),s(4753),s(1517),s(5866);var l=s(3191),a=s(8716),r=s(7922),i=s.n(r),n=s(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let o=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4753)),"C:\\Users\\lenovo\\Documents\\fpj-storytelling\\fpj-storytelling\\next-app\\src\\app\\admin\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1517)),"C:\\Users\\lenovo\\Documents\\fpj-storytelling\\fpj-storytelling\\next-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\lenovo\\Documents\\fpj-storytelling\\fpj-storytelling\\next-app\\src\\app\\admin\\page.tsx"],x="/admin/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},87:(e,t,s)=>{Promise.resolve().then(s.bind(s,4189))},4189:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var l=s(326),a=s(7577);function r(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[i,n]=(0,a.useState)(null),[d,o]=(0,a.useState)(""),[c,x]=(0,a.useState)(!1),[p,m]=(0,a.useState)("all"),h=e.filter(e=>"all"===p||(e.status||"pending")===p),u=async()=>{try{let e=await fetch("/api/partner-applications/admin",{headers:{Authorization:`Bearer ${d}`}});if(e.ok){let s=await e.json();t(s.items||[]),x(!0)}else console.error("Failed to fetch applications"),x(!1)}catch(e){console.error("Error fetching applications:",e)}r(!1)},j=async e=>{try{let s=await fetch("/api/partner-applications/admin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({action:"approve",applicationId:e.id})}),l=await s.json();if(s.ok){let s={...e,status:"approved",referral_code:l.referralCode,approval_date:new Date().toISOString()};t(t=>t.map(t=>t.id===e.id?s:t)),alert(`Application approved! Referral code: ${l.referralCode}`),n(null)}else alert(`Error: ${l.error||"Failed to approve application"}`)}catch(e){console.error("Error approving application:",e),alert("Error approving application")}},g=async(e,s)=>{try{let l=await fetch("/api/partner-applications/admin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({action:"reject",applicationId:e.id,reason:s})}),a=await l.json();if(l.ok){let l={...e,status:"rejected",admin_notes:s};t(t=>t.map(t=>t.id===e.id?l:t)),alert("Application rejected successfully"),n(null)}else alert(`Error: ${a.error||"Failed to reject application"}`)}catch(e){console.error("Error rejecting application:",e),alert("Error rejecting application")}};return c?(0,l.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Student Partner Admin Dashboard"}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("span",{className:"text-sm text-slate-600",children:[e.length," applications"]}),l.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Refresh"})]})]})})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:e.filter(e=>!e.status||"pending"===e.status).length}),l.jsx("div",{className:"text-slate-600",children:"Pending Review"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[l.jsx("div",{className:"text-3xl font-bold text-green-600",children:e.filter(e=>"approved"===e.status).length}),l.jsx("div",{className:"text-slate-600",children:"Approved"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[l.jsx("div",{className:"text-3xl font-bold text-red-600",children:e.filter(e=>"rejected"===e.status).length}),l.jsx("div",{className:"text-slate-600",children:"Rejected"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[l.jsx("div",{className:"text-3xl font-bold text-purple-600",children:e.filter(e=>e.referral_code).length}),l.jsx("div",{className:"text-slate-600",children:"Active Partners"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Applications"}),l.jsx("div",{className:"flex gap-2",children:(0,l.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"px-3 py-2 border rounded-lg text-sm",children:[(0,l.jsxs)("option",{value:"all",children:["All Applications (",e.length,")"]}),(0,l.jsxs)("option",{value:"pending",children:["Pending (",e.filter(e=>"pending"===(e.status||"pending")).length,")"]}),(0,l.jsxs)("option",{value:"approved",children:["Approved (",e.filter(e=>"approved"===e.status).length,")"]}),(0,l.jsxs)("option",{value:"rejected",children:["Rejected (",e.filter(e=>"rejected"===e.status).length,")"]})]})})]}),l.jsx("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Student"}),l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Institution"}),l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Year"}),l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Applied"}),l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Status"}),l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Referral Code"}),l.jsx("th",{className:"text-left px-6 py-3 text-sm font-medium text-slate-600",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y",children:h.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-slate-50",children:[l.jsx("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{children:[l.jsx("div",{className:"font-medium text-slate-900",children:e.name}),l.jsx("div",{className:"text-sm text-slate-500",children:e.email})]})}),l.jsx("td",{className:"px-6 py-4 text-slate-900",children:e.institution}),l.jsx("td",{className:"px-6 py-4 text-slate-900",children:e.year}),l.jsx("td",{className:"px-6 py-4 text-slate-500",children:new Date(e.created_at).toLocaleDateString()}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"approved"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:e.status||"pending"})}),l.jsx("td",{className:"px-6 py-4",children:e.referral_code?l.jsx("span",{className:"font-mono text-sm bg-slate-100 px-2 py-1 rounded",children:e.referral_code}):l.jsx("span",{className:"text-slate-400",children:"-"})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("button",{onClick:()=>n(e),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Review"})})]},e.id))})]})})]})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsx("div",{className:"px-6 py-4 border-b",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Review Application"}),l.jsx("button",{onClick:()=>n(null),className:"text-slate-400 hover:text-slate-600",children:"âœ•"})]})}),(0,l.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Name"}),l.jsx("div",{className:"text-slate-900",children:i.name})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Email"}),l.jsx("div",{className:"text-slate-900",children:i.email})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Institution"}),l.jsx("div",{className:"text-slate-900",children:i.institution})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Year"}),l.jsx("div",{className:"text-slate-900",children:i.year})]}),i.phone&&(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Phone"}),l.jsx("div",{className:"text-slate-900",children:i.phone})]}),i.course&&(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Course"}),l.jsx("div",{className:"text-slate-900",children:i.course})]})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Motivation"}),l.jsx("div",{className:"bg-slate-50 p-3 rounded-lg text-slate-900",children:i.motivation})]}),i.referral_code&&(0,l.jsxs)("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[l.jsx("div",{className:"font-medium text-green-800",children:"Referral Code Generated"}),l.jsx("div",{className:"font-mono text-lg text-green-700",children:i.referral_code})]})]}),(0,l.jsxs)("div",{className:"px-6 py-4 border-t bg-slate-50 flex gap-3 justify-end",children:[l.jsx("button",{onClick:()=>n(null),className:"px-4 py-2 text-slate-600 hover:text-slate-800",children:"Cancel"}),(!i.status||"pending"===i.status)&&(0,l.jsxs)(l.Fragment,{children:[l.jsx("button",{onClick:()=>{let e=prompt("Rejection reason:");e&&g(i,e)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reject"}),l.jsx("button",{onClick:()=>j(i),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Approve & Generate Code"})]})]})]})})]}):l.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full",children:[l.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin Login"}),l.jsx("input",{type:"password",placeholder:"Enter admin token",value:d,onChange:e=>o(e.target.value),className:"w-full p-3 border rounded-lg mb-4",onKeyPress:e=>"Enter"===e.key&&u()}),l.jsx("button",{onClick:u,className:"w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700",children:"Login"})]})})}},4753:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});let l=(0,s(8570).createProxy)(String.raw`C:\Users\lenovo\Documents\fpj-storytelling\fpj-storytelling\next-app\src\app\admin\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[948,982,15],()=>s(5562));module.exports=l})();